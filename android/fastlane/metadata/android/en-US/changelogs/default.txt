Fixed minor bugs and added new features